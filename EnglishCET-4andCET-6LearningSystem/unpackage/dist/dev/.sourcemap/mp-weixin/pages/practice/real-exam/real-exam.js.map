{"version":3,"file":"real-exam.js","sources":["pages/practice/real-exam/real-exam.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJhY3RpY2UvcmVhbC1leGFtL3JlYWwtZXhhbS52dWU"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted } from 'vue'\r\n\r\n/**\r\n * @description 考试时间（分钟）\r\n */\r\nconst EXAM_TIME = 45  // 真题练习时间更长\r\n\r\n/**\r\n * @description 考试状态\r\n */\r\nconst examStatus = ref('ready') // ready-准备开始, ongoing-考试中, finished-已结束\r\n\r\n/**\r\n * @description 剩余时间（秒）\r\n */\r\nconst remainingTime = ref(EXAM_TIME * 60)\r\n\r\n/**\r\n * @description 题目列表\r\n */\r\nconst questionList = ref([])\r\n\r\n/**\r\n * @description 当前题目索引\r\n */\r\nconst currentIndex = ref(0)\r\n\r\n/**\r\n * @description 用户答案\r\n */\r\nconst userAnswers = ref([])\r\n\r\n/**\r\n * @description 计时器\r\n */\r\nlet timer = null\r\n\r\n/**\r\n * @description 分数\r\n */\r\nconst score = ref(0)\r\n\r\n/**\r\n * @description 是否显示解析\r\n */\r\nconst showAnalysis = ref(false)\r\n\r\n/**\r\n * @description 当前选择的类别\r\n */\r\nconst currentCategory = ref('CET4')\r\n\r\n/**\r\n * @description 类别选项\r\n */\r\nconst categoryOptions = ref([\r\n  { value: 'CET4', label: '四级真题' },\r\n  { value: 'CET6', label: '六级真题' }\r\n])\r\n\r\n/**\r\n * @description 年份列表\r\n */\r\nconst yearList = ref([])\r\n\r\n/**\r\n * @description 当前选择的年份\r\n */\r\nconst currentYear = ref('')\r\n\r\n/**\r\n * @description 当前选择的月份\r\n */\r\nconst currentMonth = ref('')\r\n\r\n/**\r\n * @description 试卷数据\r\n */\r\nconst paperData = ref(null)\r\n\r\n/**\r\n * @description 加载题目\r\n */\r\nconst loadQuestions = async () => {\r\n  try {\r\n    uni.showLoading({\r\n      title: '加载中...'\r\n    })\r\n    \r\n    const { result } = await uniCloud.callFunction({\r\n      name: 'getExamQuestions',\r\n      data: {\r\n        type: 'real',\r\n        count: 20  // 真题练习题目数量较少\r\n      }\r\n    })\r\n    \r\n    if (result.code === 0) {\r\n      questionList.value = result.data\r\n      userAnswers.value = new Array(questionList.value.length).fill('')\r\n    } else {\r\n      uni.showToast({\r\n        title: result.msg || '加载题目失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n  } catch (e) {\r\n    console.error(e)\r\n    uni.showToast({\r\n      title: '加载题目失败',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    uni.hideLoading()\r\n  }\r\n}\r\n\r\n/**\r\n * @description 开始考试\r\n */\r\nconst startExam = () => {\r\n  examStatus.value = 'ongoing'\r\n  startTimer()\r\n}\r\n\r\n/**\r\n * @description 开始计时\r\n */\r\nconst startTimer = () => {\r\n  timer = setInterval(() => {\r\n    if (remainingTime.value > 0) {\r\n      remainingTime.value--\r\n    } else {\r\n      finishExam()\r\n    }\r\n  }, 1000)\r\n}\r\n\r\n/**\r\n * @description 结束考试\r\n */\r\nconst finishExam = async () => {\r\n  clearInterval(timer)\r\n  examStatus.value = 'finished'\r\n  showAnalysis.value = true\r\n  \r\n  try {\r\n    uni.showLoading({\r\n      title: '正在提交...'\r\n    })\r\n    \r\n    const { result } = await uniCloud.callFunction({\r\n      name: 'savePracticeRecord',\r\n      data: {\r\n        practice_type: 'real',\r\n        answers: userAnswers.value.map((answer, index) => ({\r\n          questionId: questionList.value[index]._id,\r\n          answer,\r\n          isCorrect: answer === questionList.value[index].answer\r\n        })),\r\n        duration: EXAM_TIME * 60 - remainingTime.value\r\n      }\r\n    })\r\n    \r\n    if (result.code === 0) {\r\n      score.value = result.data.score\r\n    } else {\r\n      uni.showToast({\r\n        title: result.msg || '提交失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n  } catch (e) {\r\n    console.error('保存练习记录失败', e)\r\n    uni.showToast({\r\n      title: '提交失败',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    uni.hideLoading()\r\n  }\r\n}\r\n\r\n/**\r\n * @description 选择答案\r\n */\r\nconst selectAnswer = (answer) => {\r\n  userAnswers.value[currentIndex.value] = answer\r\n}\r\n\r\n/**\r\n * @description 下一题\r\n */\r\nconst nextQuestion = () => {\r\n  if (currentIndex.value < questionList.value.length - 1) {\r\n    currentIndex.value++\r\n  }\r\n}\r\n\r\n/**\r\n * @description 上一题\r\n */\r\nconst prevQuestion = () => {\r\n  if (currentIndex.value > 0) {\r\n    currentIndex.value--\r\n  }\r\n}\r\n\r\n/**\r\n * @description 格式化时间\r\n */\r\nconst formatTime = (seconds) => {\r\n  const minutes = Math.floor(seconds / 60)\r\n  const remainingSeconds = seconds % 60\r\n  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`\r\n}\r\n\r\n/**\r\n * @description 加载年份列表\r\n */\r\nconst loadYearList = async () => {\r\n  try {\r\n    uni.showLoading({\r\n      title: '加载中...'\r\n    })\r\n    \r\n    const { result } = await uniCloud.callFunction({\r\n      name: 'getRealExamYears',\r\n      data: {\r\n        category: currentCategory.value\r\n      }\r\n    })\r\n    \r\n    if (result.code === 0) {\r\n      yearList.value = result.data\r\n      if (yearList.value.length > 0) {\r\n        currentYear.value = yearList.value[0].year\r\n        currentMonth.value = yearList.value[0].months[0]\r\n      }\r\n    } else {\r\n      throw new Error('加载年份列表失败')\r\n    }\r\n  } catch (e) {\r\n    console.error(e)\r\n    uni.showToast({\r\n      title: '加载年份列表失败',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    uni.hideLoading()\r\n  }\r\n}\r\n\r\n/**\r\n * @description 加载试卷\r\n */\r\nconst loadPaper = async () => {\r\n  if (!currentYear.value || !currentMonth.value) return\r\n  \r\n  try {\r\n    uni.showLoading({\r\n      title: '加载中...'\r\n    })\r\n    \r\n    const { result } = await uniCloud.callFunction({\r\n      name: 'getRealExamPaper',\r\n      data: {\r\n        category: currentCategory.value,\r\n        year: currentYear.value,\r\n        month: currentMonth.value\r\n      }\r\n    })\r\n    \r\n    if (result.code === 0) {\r\n      paperData.value = result.data\r\n    } else {\r\n      throw new Error('加载试卷失败')\r\n    }\r\n  } catch (e) {\r\n    console.error(e)\r\n    uni.showToast({\r\n      title: '加载试卷失败',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    uni.hideLoading()\r\n  }\r\n}\r\n\r\n/**\r\n * @description 开始练习\r\n */\r\nconst startPractice = () => {\r\n  uni.navigateTo({\r\n    url: `/pages/practice/mock-exam/mock-exam?category=${currentCategory.value}&year=${currentYear.value}&month=${currentMonth.value}&type=real`\r\n  })\r\n}\r\n\r\n/**\r\n * @description 切换类别\r\n */\r\nconst handleCategoryChange = (category) => {\r\n  currentCategory.value = category\r\n  currentYear.value = ''\r\n  currentMonth.value = ''\r\n  paperData.value = null\r\n  loadYearList()\r\n}\r\n\r\n/**\r\n * @description 切换年份\r\n */\r\nconst handleYearChange = (year) => {\r\n  currentYear.value = year\r\n  currentMonth.value = yearList.value.find(item => item.year === year).months[0]\r\n  loadPaper()\r\n}\r\n\r\n/**\r\n * @description 切换月份\r\n */\r\nconst handleMonthChange = (month) => {\r\n  currentMonth.value = month\r\n  loadPaper()\r\n}\r\n\r\nonMounted(() => {\r\n  if (!uni.getStorageSync('userInfo')) {\r\n    uni.showToast({\r\n      title: '请先登录',\r\n      icon: 'none',\r\n      duration: 2000\r\n    })\r\n    uni.navigateTo({\r\n      url: '/pages/login/login'\r\n    })\r\n  } else {\r\n    loadYearList()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <view class=\"container\">\r\n    <!-- 准备开始 -->\r\n    <view class=\"ready-card\" v-if=\"examStatus === 'ready'\">\r\n      <view class=\"ready-title\">真题练习</view>\r\n      <view class=\"ready-info\">\r\n        <text>练习时长：{{ EXAM_TIME }}分钟</text>\r\n        <text>题目数量：{{ questionList.length }}题</text>\r\n      </view>\r\n      <button class=\"btn primary\" @tap=\"startExam\">开始练习</button>\r\n    </view>\r\n    \r\n    <!-- 练习中 -->\r\n    <view class=\"exam-content\" v-else-if=\"examStatus === 'ongoing'\">\r\n      <!-- 顶部进度 -->\r\n      <view class=\"exam-header\">\r\n        <text class=\"progress\">{{ currentIndex + 1 }}/{{ questionList.length }}</text>\r\n        <text class=\"timer\">{{ formatTime(remainingTime) }}</text>\r\n      </view>\r\n      \r\n      <!-- 题目内容 -->\r\n      <view class=\"question-card\" v-if=\"questionList[currentIndex]\">\r\n        <view class=\"question-title\">{{ questionList[currentIndex].title }}</view>\r\n        <view class=\"options\">\r\n          <view \r\n            class=\"option-item\"\r\n            v-for=\"option in questionList[currentIndex].options\"\r\n            :key=\"option.key\"\r\n            :class=\"{ active: userAnswers[currentIndex] === option.key }\"\r\n            @tap=\"selectAnswer(option.key)\"\r\n          >\r\n            <text class=\"option-key\">{{ option.key }}</text>\r\n            <text class=\"option-content\">{{ option.content }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- 底部按钮 -->\r\n      <view class=\"exam-footer\">\r\n        <button class=\"btn\" @tap=\"prevQuestion\">上一题</button>\r\n        <button class=\"btn\" @tap=\"nextQuestion\">下一题</button>\r\n        <button class=\"btn primary\" @tap=\"finishExam\">完成练习</button>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 练习结束 -->\r\n    <view class=\"result-card\" v-else>\r\n      <view class=\"result-title\">练习结束</view>\r\n      <view class=\"result-info\">\r\n        <text>用时：{{ EXAM_TIME * 60 - remainingTime }}秒</text>\r\n        <text>得分：{{ score }}</text>\r\n      </view>\r\n      \r\n      <!-- 题目解析 -->\r\n      <view class=\"analysis-section\" v-if=\"showAnalysis\">\r\n        <view class=\"analysis-title\">题目解析</view>\r\n        <view class=\"question-list\">\r\n          <view \r\n            class=\"question-item\"\r\n            v-for=\"(question, index) in questionList\"\r\n            :key=\"index\"\r\n          >\r\n            <view class=\"question-header\">\r\n              <text class=\"question-number\">第{{ index + 1 }}题</text>\r\n              <text :class=\"['answer-status', userAnswers[index] === question.answer ? 'correct' : 'wrong']\">\r\n                {{ userAnswers[index] === question.answer ? '正确' : '错误' }}\r\n              </text>\r\n            </view>\r\n            <view class=\"question-content\">{{ question.title }}</view>\r\n            <view class=\"correct-answer\">正确答案：{{ question.answer }}</view>\r\n            <view class=\"analysis-content\">{{ question.analysis }}</view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      \r\n      <button class=\"btn primary\" @tap=\"navigateToPage('/pages/practice/practice')\">返回</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<style>\r\n.container {\r\n  padding: 30rpx;\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n}\r\n\r\n.ready-card,\r\n.result-card {\r\n  background-color: #fff;\r\n  border-radius: 20rpx;\r\n  padding: 40rpx;\r\n  text-align: center;\r\n}\r\n\r\n.ready-title,\r\n.result-title {\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.ready-info,\r\n.result-info {\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.ready-info text,\r\n.result-info text {\r\n  display: block;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.exam-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 20rpx;\r\n  background-color: #fff;\r\n  border-radius: 10rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.progress,\r\n.timer {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.question-card {\r\n  background-color: #fff;\r\n  border-radius: 20rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.question-title {\r\n  font-size: 32rpx;\r\n  color: #333;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.options {\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.option-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 20rpx;\r\n  border: 1px solid #eee;\r\n  border-radius: 10rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.option-item.active {\r\n  background-color: #4095E5;\r\n  border-color: #4095E5;\r\n}\r\n\r\n.option-item.active text {\r\n  color: #fff;\r\n}\r\n\r\n.option-key {\r\n  width: 60rpx;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.option-content {\r\n  flex: 1;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.exam-footer {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 20rpx 0;\r\n}\r\n\r\n.exam-footer .btn {\r\n  width: 30%;\r\n}\r\n\r\n/* 解析部分样式 */\r\n.analysis-section {\r\n  margin-top: 40rpx;\r\n  text-align: left;\r\n}\r\n\r\n.analysis-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.question-list {\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.question-item {\r\n  background-color: #f8f8f8;\r\n  border-radius: 10rpx;\r\n  padding: 20rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.question-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.question-number {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.answer-status {\r\n  font-size: 28rpx;\r\n}\r\n\r\n.answer-status.correct {\r\n  color: #4caf50;\r\n}\r\n\r\n.answer-status.wrong {\r\n  color: #f44336;\r\n}\r\n\r\n.question-content {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.correct-answer {\r\n  font-size: 28rpx;\r\n  color: #4caf50;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.analysis-content {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  background-color: #fff;\r\n  padding: 10rpx;\r\n  border-radius: 6rpx;\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/yulidanprogram/second/EnglishCET-4andCET-6LearningSystem/pages/practice/real-exam/real-exam.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","uniCloud","onMounted","MiniProgramPage"],"mappings":"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"}