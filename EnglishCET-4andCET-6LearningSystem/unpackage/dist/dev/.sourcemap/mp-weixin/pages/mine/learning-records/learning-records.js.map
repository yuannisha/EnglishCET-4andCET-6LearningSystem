{"version":3,"file":"learning-records.js","sources":["pages/mine/learning-records/learning-records.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWluZS9sZWFybmluZy1yZWNvcmRzL2xlYXJuaW5nLXJlY29yZHMudnVl"],"sourcesContent":["<script setup>\nimport { ref, onMounted } from 'vue'\n\n/**\n * @description 记录列表\n */\nconst recordList = ref([])\n\n/**\n * @description 分页相关参数\n */\nconst pagination = ref({\n  current: 1,\n  pageSize: 10,\n  total: 0\n})\n\n/**\n * @description 当前选择的类别\n */\nconst currentCategory = ref('CET4')\n\n/**\n * @description 类别选项\n */\nconst categoryOptions = ref([\n  { value: 'CET4', label: '大学英语四级' },\n  { value: 'CET6', label: '大学英语六级' }\n])\n\n/**\n * @description 当前选择的练习类型\n */\nconst currentType = ref('all')\n\n/**\n * @description 练习类型选项\n */\nconst typeOptions = ref([\n  { value: 'all', label: '全部' },\n  { value: 'mock', label: '模拟考试' },\n  { value: 'real', label: '真题练习' },\n  { value: 'listening', label: '听力练习' },\n  { value: 'reading', label: '阅读练习' },\n  { value: 'writing', label: '写作练习' },\n  { value: 'translation', label: '翻译练习' },\n  { value: 'real_listening', label: '听力真题' },\n  { value: 'real_reading', label: '阅读真题' },\n  { value: 'real_translation', label: '翻译真题' },\n  { value: 'real_writing', label: '写作真题' }\n])\n\n/**\n * @description 加载练习记录\n */\nconst loadRecords = async () => {\n  try {\n    uni.showLoading({\n      title: '加载中...'\n    })\n    const { result } = await uniCloud.callFunction({\n      name: 'getPracticeRecords',\n      data: {\n        user_id: uni.getStorageSync('userInfo')._id,\n        category: currentCategory.value,\n        practice_type: currentType.value === 'all' ? undefined : currentType.value,\n        page: pagination.value.current,\n        pageSize: pagination.value.pageSize\n      }\n    })\n    \n    if (result.code === 0) {\n      recordList.value = result.data.list\n      pagination.value.total = result.data.total\n      console.log(\"recordList\",recordList.value)\n    } else {\n      throw new Error(result.msg)\n    }\n  } catch (e) {\n    uni.showToast({\n      title: '加载记录失败',\n      icon: 'none'\n    })\n  } finally {\n    uni.hideLoading()\n  }\n}\n\n/**\n * @description 切换类别\n */\nconst handleCategoryChange = (category) => {\n  currentCategory.value = category\n  pagination.value.current = 1 // 切换类别时重置页码\n  loadRecords()\n}\n\n/**\n * @description 切换练习类型\n */\nconst handleTypeChange = (type) => {\n  currentType.value = type\n  pagination.value.current = 1 // 切换类型时重置页码\n  loadRecords()\n}\n\n/**\n * @description 切换页码\n */\nconst handlePageChange = (page) => {\n  pagination.value.current = page\n  loadRecords()\n}\n\n/**\n * @description 格式化时间\n */\nconst formatDate = (timestamp) => {\n  const date = new Date(timestamp)\n  return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`\n}\n\n/**\n * @description 格式化练习类型\n */\nconst formatType = (type) => {\n  const option = typeOptions.value.find(item => item.value === type)\n  return option ? option.label : type\n}\n\n/**\n * @description 格式化练习时长\n */\nconst formatDuration = (duration) => {\n  const minutes = Math.floor(duration / 60);  \n  const seconds = duration % 60;  \n  return `${minutes}分${seconds}秒`;  \n}   \n\nonMounted(() => {\n  if (!uni.getStorageSync('userInfo')) {\n    uni.showToast({\n      title: '请先登录',\n      icon: 'none',\n      duration: 2000\n    })\n    uni.navigateTo({\n      url: '/pages/login/login'\n    })\n  } else {\n    loadRecords()\n  }\n})\n</script>\n\n<template>\n  <view class=\"container\">\n    <!-- 筛选区域 -->\n    <view class=\"filter-area\">\n      <view class=\"filter-row\">\n        <view class=\"filter-item\">\n          <text class=\"label\">考试类型</text>\n          <view class=\"options\">\n            <view\n              class=\"option\"\n              v-for=\"item in categoryOptions\"\n              :key=\"item.value\"\n              :class=\"{ active: currentCategory === item.value }\"\n              @tap=\"handleCategoryChange(item.value)\"\n            >\n              {{ item.label }}\n            </view>\n          </view>\n        </view>\n      </view>\n      \n      <view class=\"filter-row\">\n        <view class=\"filter-item\">\n          <text class=\"label\">练习类型</text>\n          <view class=\"options\">\n            <view\n              class=\"option\"\n              v-for=\"item in typeOptions\"\n              :key=\"item.value\"\n              :class=\"{ active: currentType === item.value }\"\n              @tap=\"handleTypeChange(item.value)\"\n            >\n              {{ item.label }}\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 记录列表 -->\n    <scroll-view class=\"record-list\" scroll-y>\n      <view v-if=\"recordList.length > 0\">\n        <view\n          class=\"record-item\"\n          v-for=\"(record, index) in recordList\"\n          :key=\"record._id\"\n        >\n          <view class=\"record-header\">\n            <text class=\"practice-type\">{{ formatType(record.practice_type) }}</text>\n            <text class=\"practice-date\">{{ formatDate(record.create_date) }}</text>\n          </view>\n          \n          <view class=\"record-content\">\n            <view class=\"score-info\">\n              <view class=\"score-item\">\n                <text class=\"label\">得分</text>\n                <text class=\"value\">{{ record.scores?.total || record.lastScore }}</text>\n              </view>\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\n                <text class=\"label\">听力</text>\n                <text class=\"value\">{{ record.scores?.listening || 0 }}</text>\n              </view>\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\n                <text class=\"label\">阅读</text>\n                <text class=\"value\">{{ record.scores?.reading || 0 }}</text>\n              </view>\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\n                <text class=\"label\">翻译</text>\n                <text class=\"value\">{{ record.scores?.translation || 0 }}</text>\n              </view>\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\n                <text class=\"label\">写作</text>\n                <text class=\"value\">{{ record.scores?.writing || 0 }}</text>\n              </view>\n            </view>\n            \n            <view class=\"practice-info\">\n              <view class=\"info-item\" v-if=\"record.duration\">\n                <text class=\"label\">练习时长</text>\n                <text class=\"value\">{{ formatDuration(record.duration) }}</text>\n              </view>\n              <view class=\"info-item\" v-if=\"record.practice_type !== 'mock' && record.practice_type !== 'translation' && record.practice_type !== 'writing' && record.practice_type !== 'real_translation' && record.practice_type !== 'real_writing'\">\n                <text class=\"label\">正确率</text>\n                <text class=\"value\">{{ record.lastCorrectRate }}%</text>\n              </view>\n              <view class=\"info-item\" v-if=\"record.practice_type !== 'mock' && record.practice_type !== 'translation' && record.practice_type !== 'writing' && record.practice_type !== 'real_translation' && record.practice_type !== 'real_writing'\">\n                <text class=\"label\">正确题数</text>\n                <text class=\"value\" v-if=\"record.practice_type === 'real_listening' || record.practice_type === 'listening'\">{{ record.lastCorrectCount }}/25</text>\n                <text class=\"value\" v-if=\"record.practice_type === 'real_reading' || record.practice_type === 'reading'\">{{ record.lastCorrectCount }}/5</text>\n              </view>\n              <view class=\"info-item\" v-if=\"record.practice_type === 'translation' || record.practice_type === 'writing' || record.practice_type === 'real_translation' || record.practice_type === 'real_writing'\">\n                <text class=\"label\">满分</text>\n                <text class=\"value\">106.5</text>\n              </view>\n            </view>\n          </view>\n        </view>\n      </view>\n      <view v-else class=\"empty-tip\">\n        <text>暂无练习记录</text>\n      </view>\n    </scroll-view>\n    \n    <!-- 分页控制 -->\n    <view class=\"pagination\" v-if=\"recordList.length > 0\">\n      <view class=\"page-info\">\n        <text>共 {{ pagination.total }} 条记录</text>\n      </view>\n      <view class=\"page-controls\">\n        <button \n          class=\"page-btn\" \n          :disabled=\"pagination.current <= 1\"\n          @tap=\"handlePageChange(pagination.current - 1)\"\n        >\n          上一页\n        </button>\n        <text class=\"page-number\">第 {{ pagination.current }} 页</text>\n        <button \n          class=\"page-btn\" \n          :disabled=\"pagination.current >= Math.ceil(pagination.total / pagination.pageSize)\"\n          @tap=\"handlePageChange(pagination.current + 1)\"\n        >\n          下一页\n        </button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<style>\n.container {\n  padding: 30rpx;\n  background-color: #f5f5f5;\n  min-height: 100vh;\n}\n\n.filter-area {\n  background-color: #fff;\n  border-radius: 20rpx;\n  padding: 20rpx;\n  margin-bottom: 30rpx;\n}\n\n.filter-row {\n  margin-bottom: 20rpx;\n}\n\n.filter-row:last-child {\n  margin-bottom: 0;\n}\n\n.filter-item {\n  display: flex;\n  flex-direction: column;\n}\n\n.label {\n  font-size: 28rpx;\n  color: #666;\n  margin-bottom: 20rpx;\n}\n\n.options {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx;\n}\n\n.option {\n  padding: 10rpx 30rpx;\n  font-size: 26rpx;\n  color: #666;\n  background-color: #f8f8f8;\n  border-radius: 30rpx;\n}\n\n.option.active {\n  background-color: #4095E5;\n  color: #fff;\n}\n\n.record-list {\n  height: calc(100vh - 400rpx); /* 调整高度以适应分页控件 */\n}\n\n.record-item {\n  background-color: #fff;\n  border-radius: 20rpx;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n}\n\n.record-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20rpx;\n}\n\n.practice-type {\n  font-size: 32rpx;\n  color: #333;\n  font-weight: bold;\n}\n\n.practice-date {\n  font-size: 26rpx;\n  color: #999;\n}\n\n.record-content {\n  background-color: #f9f9f9;\n  border-radius: 10rpx;\n  padding: 20rpx;\n}\n\n.score-info {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx;\n  margin-bottom: 20rpx;\n  padding-bottom: 20rpx;\n  border-bottom: 1px solid #eee;\n}\n\n.score-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  min-width: 120rpx;\n}\n\n.score-item .label {\n  font-size: 24rpx;\n  color: #666;\n  margin-bottom: 10rpx;\n}\n\n.score-item .value {\n  font-size: 32rpx;\n  color: #4095E5;\n  font-weight: bold;\n}\n\n.practice-info {\n  display: flex;\n  justify-content: space-around;\n}\n\n.info-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.info-item .label {\n  font-size: 24rpx;\n  color: #666;\n  margin-bottom: 10rpx;\n}\n\n.info-item .value {\n  font-size: 28rpx;\n  color: #333;\n}\n\n.empty-tip {\n  text-align: center;\n  padding: 100rpx 0;\n  color: #999;\n  font-size: 28rpx;\n}\n\n.pagination {\n  background-color: #fff;\n  padding: 20rpx;\n  border-radius: 20rpx;\n  margin-top: 20rpx;\n}\n\n.page-info {\n  text-align: center;\n  font-size: 24rpx;\n  color: #666;\n  margin-bottom: 20rpx;\n}\n\n.page-controls {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 20rpx;\n}\n\n.page-btn {\n  font-size: 26rpx;\n  padding: 10rpx 30rpx;\n  background-color: #4095E5;\n  color: #fff;\n  border-radius: 30rpx;\n}\n\n.page-btn[disabled] {\n  background-color: #ccc;\n  color: #fff;\n}\n\n.page-number {\n  font-size: 26rpx;\n  color: #333;\n}\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/yulidanprogram/second/EnglishCET-4andCET-6LearningSystem/pages/mine/learning-records/learning-records.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","uniCloud","onMounted","MiniProgramPage"],"mappings":"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"}