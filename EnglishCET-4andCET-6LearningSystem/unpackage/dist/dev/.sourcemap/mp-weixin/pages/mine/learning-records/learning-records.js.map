{"version":3,"file":"learning-records.js","sources":["pages/mine/learning-records/learning-records.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWluZS9sZWFybmluZy1yZWNvcmRzL2xlYXJuaW5nLXJlY29yZHMudnVl"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted } from 'vue'\r\n\r\n/**\r\n * @description 记录列表\r\n */\r\nconst recordList = ref([])\r\n\r\n/**\r\n * @description 分页相关参数\r\n */\r\nconst pagination = ref({\r\n  current: 1,\r\n  pageSize: 10,\r\n  total: 0\r\n})\r\n\r\n/**\r\n * @description 当前选择的类别\r\n */\r\nconst currentCategory = ref('CET4')\r\n\r\n/**\r\n * @description 类别选项\r\n */\r\nconst categoryOptions = ref([\r\n  { value: 'CET4', label: '大学英语四级' },\r\n  { value: 'CET6', label: '大学英语六级' }\r\n])\r\n\r\n/**\r\n * @description 当前选择的练习类型\r\n */\r\nconst currentType = ref('all')\r\n\r\n/**\r\n * @description 练习类型选项\r\n */\r\nconst typeOptions = ref([\r\n  { value: 'all', label: '全部' },\r\n  { value: 'mock', label: '模拟考试' },\r\n  { value: 'real', label: '真题练习' },\r\n  { value: 'listening', label: '听力练习' },\r\n  { value: 'reading', label: '阅读练习' },\r\n  { value: 'writing', label: '写作练习' },\r\n  { value: 'translation', label: '翻译练习' },\r\n  { value: 'real_listening', label: '听力真题' },\r\n  { value: 'real_reading', label: '阅读真题' },\r\n  { value: 'real_translation', label: '翻译真题' },\r\n  { value: 'real_writing', label: '写作真题' }\r\n])\r\n\r\n/**\r\n * @description 加载练习记录\r\n */\r\nconst loadRecords = async () => {\r\n  try {\r\n    uni.showLoading({\r\n      title: '加载中...'\r\n    })\r\n    const { result } = await uniCloud.callFunction({\r\n      name: 'getPracticeRecords',\r\n      data: {\r\n        user_id: uni.getStorageSync('userInfo')._id,\r\n        category: currentCategory.value,\r\n        practice_type: currentType.value === 'all' ? undefined : currentType.value,\r\n        page: pagination.value.current,\r\n        pageSize: pagination.value.pageSize\r\n      }\r\n    })\r\n    \r\n    if (result.code === 0) {\r\n      recordList.value = result.data.list\r\n      pagination.value.total = result.data.total\r\n      console.log(\"recordList\",recordList.value)\r\n    } else {\r\n      throw new Error(result.msg)\r\n    }\r\n  } catch (e) {\r\n    uni.showToast({\r\n      title: '加载记录失败',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    uni.hideLoading()\r\n  }\r\n}\r\n\r\n/**\r\n * @description 切换类别\r\n */\r\nconst handleCategoryChange = (category) => {\r\n  currentCategory.value = category\r\n  loadRecords()\r\n}\r\n\r\n/**\r\n * @description 切换练习类型\r\n */\r\nconst handleTypeChange = (type) => {\r\n  currentType.value = type\r\n  loadRecords()\r\n}\r\n\r\n/**\r\n * @description 切换页码\r\n */\r\nconst handlePageChange = (page) => {\r\n  pagination.value.current = page\r\n  loadRecords()\r\n}\r\n\r\n/**\r\n * @description 格式化时间\r\n */\r\nconst formatDate = (timestamp) => {\r\n  const date = new Date(timestamp)\r\n  return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`\r\n}\r\n\r\n/**\r\n * @description 格式化练习类型\r\n */\r\nconst formatType = (type) => {\r\n  const option = typeOptions.value.find(item => item.value === type)\r\n  return option ? option.label : type\r\n}\r\n\r\n/**\r\n * @description 格式化练习时长\r\n */\r\nconst formatDuration = (duration) => {\r\n  const minutes = Math.floor(duration / 60);  \r\n  const seconds = duration % 60;  \r\n  return `${minutes}分${seconds}秒`;  \r\n}   \r\n\r\nonMounted(() => {\r\n  if (!uni.getStorageSync('userInfo')) {\r\n    uni.showToast({\r\n      title: '请先登录',\r\n      icon: 'none',\r\n      duration: 2000\r\n    })\r\n    uni.navigateTo({\r\n      url: '/pages/login/login'\r\n    })\r\n  } else {\r\n    loadRecords()\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <view class=\"container\">\r\n    <!-- 筛选区域 -->\r\n    <view class=\"filter-area\">\r\n      <view class=\"filter-row\">\r\n        <view class=\"filter-item\">\r\n          <text class=\"label\">考试类型</text>\r\n          <view class=\"options\">\r\n            <view\r\n              class=\"option\"\r\n              v-for=\"item in categoryOptions\"\r\n              :key=\"item.value\"\r\n              :class=\"{ active: currentCategory === item.value }\"\r\n              @tap=\"handleCategoryChange(item.value)\"\r\n            >\r\n              {{ item.label }}\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      \r\n      <view class=\"filter-row\">\r\n        <view class=\"filter-item\">\r\n          <text class=\"label\">练习类型</text>\r\n          <view class=\"options\">\r\n            <view\r\n              class=\"option\"\r\n              v-for=\"item in typeOptions\"\r\n              :key=\"item.value\"\r\n              :class=\"{ active: currentType === item.value }\"\r\n              @tap=\"handleTypeChange(item.value)\"\r\n            >\r\n              {{ item.label }}\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 记录列表 -->\r\n    <scroll-view class=\"record-list\" scroll-y>\r\n      <view v-if=\"recordList.length > 0\">\r\n        <view\r\n          class=\"record-item\"\r\n          v-for=\"(record, index) in recordList\"\r\n          :key=\"record._id\"\r\n        >\r\n          <view class=\"record-header\">\r\n            <text class=\"practice-type\">{{ formatType(record.practice_type) }}</text>\r\n            <text class=\"practice-date\">{{ formatDate(record.create_date) }}</text>\r\n          </view>\r\n          \r\n          <view class=\"record-content\">\r\n            <view class=\"score-info\">\r\n              <view class=\"score-item\">\r\n                <text class=\"label\">得分</text>\r\n                <text class=\"value\">{{ record.scores?.total || record.lastScore }}</text>\r\n              </view>\r\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\r\n                <text class=\"label\">听力</text>\r\n                <text class=\"value\">{{ record.scores?.listening || 0 }}</text>\r\n              </view>\r\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\r\n                <text class=\"label\">阅读</text>\r\n                <text class=\"value\">{{ record.scores?.reading || 0 }}</text>\r\n              </view>\r\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\r\n                <text class=\"label\">翻译</text>\r\n                <text class=\"value\">{{ record.scores?.translation || 0 }}</text>\r\n              </view>\r\n              <view class=\"score-item\" v-if=\"record.practice_type === 'mock' || record.practice_type === 'real'\">\r\n                <text class=\"label\">写作</text>\r\n                <text class=\"value\">{{ record.scores?.writing || 0 }}</text>\r\n              </view>\r\n            </view>\r\n            \r\n            <view class=\"practice-info\">\r\n              <view class=\"info-item\" v-if=\"record.duration\">\r\n                <text class=\"label\">练习时长</text>\r\n                <text class=\"value\">{{ formatDuration(record.duration) }}</text>\r\n              </view>\r\n              <view class=\"info-item\" v-if=\"record.practice_type !== 'mock' && record.practice_type !== 'translation' && record.practice_type !== 'writing' && record.practice_type !== 'real_translation' && record.practice_type !== 'real_writing'\">\r\n                <text class=\"label\">正确率</text>\r\n                <text class=\"value\">{{ record.lastCorrectRate }}%</text>\r\n              </view>\r\n              <view class=\"info-item\" v-if=\"record.practice_type !== 'mock' && record.practice_type !== 'translation' && record.practice_type !== 'writing' && record.practice_type !== 'real_translation' && record.practice_type !== 'real_writing'\">\r\n                <text class=\"label\">正确题数</text>\r\n                <text class=\"value\" v-if=\"record.practice_type === 'real_listening' || record.practice_type === 'listening'\">{{ record.lastCorrectCount }}/25</text>\r\n                <text class=\"value\" v-if=\"record.practice_type === 'real_reading' || record.practice_type === 'reading'\">{{ record.lastCorrectCount }}/5</text>\r\n              </view>\r\n              <view class=\"info-item\" v-if=\"record.practice_type === 'translation' || record.practice_type === 'writing' || record.practice_type === 'real_translation' || record.practice_type === 'real_writing'\">\r\n                <text class=\"label\">满分</text>\r\n                <text class=\"value\">106.5</text>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <view v-else class=\"empty-tip\">\r\n        <text>暂无练习记录</text>\r\n      </view>\r\n    </scroll-view>\r\n    \r\n    <!-- 分页控制 -->\r\n    <view class=\"pagination\" v-if=\"recordList.length > 0\">\r\n      <view class=\"page-info\">\r\n        <text>共 {{ pagination.total }} 条记录</text>\r\n      </view>\r\n      <view class=\"page-controls\">\r\n        <button \r\n          class=\"page-btn\" \r\n          :disabled=\"pagination.current <= 1\"\r\n          @tap=\"handlePageChange(pagination.current - 1)\"\r\n        >\r\n          上一页\r\n        </button>\r\n        <text class=\"page-number\">第 {{ pagination.current }} 页</text>\r\n        <button \r\n          class=\"page-btn\" \r\n          :disabled=\"pagination.current >= Math.ceil(pagination.total / pagination.pageSize)\"\r\n          @tap=\"handlePageChange(pagination.current + 1)\"\r\n        >\r\n          下一页\r\n        </button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<style>\r\n.container {\r\n  padding: 30rpx;\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n}\r\n\r\n.filter-area {\r\n  background-color: #fff;\r\n  border-radius: 20rpx;\r\n  padding: 20rpx;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.filter-row {\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.filter-row:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.filter-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.label {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.options {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20rpx;\r\n}\r\n\r\n.option {\r\n  padding: 10rpx 30rpx;\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  background-color: #f8f8f8;\r\n  border-radius: 30rpx;\r\n}\r\n\r\n.option.active {\r\n  background-color: #4095E5;\r\n  color: #fff;\r\n}\r\n\r\n.record-list {\r\n  height: calc(100vh - 300rpx);\r\n}\r\n\r\n.record-item {\r\n  background-color: #fff;\r\n  border-radius: 20rpx;\r\n  padding: 30rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.record-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.practice-type {\r\n  font-size: 32rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n.practice-date {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n}\r\n\r\n.record-content {\r\n  background-color: #f9f9f9;\r\n  border-radius: 10rpx;\r\n  padding: 20rpx;\r\n}\r\n\r\n.score-info {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20rpx;\r\n  margin-bottom: 20rpx;\r\n  padding-bottom: 20rpx;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.score-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  min-width: 120rpx;\r\n}\r\n\r\n.score-item .label {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.score-item .value {\r\n  font-size: 32rpx;\r\n  color: #4095E5;\r\n  font-weight: bold;\r\n}\r\n\r\n.practice-info {\r\n  display: flex;\r\n  justify-content: space-around;\r\n}\r\n\r\n.info-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.info-item .label {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.info-item .value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.empty-tip {\r\n  text-align: center;\r\n  padding: 100rpx 0;\r\n  color: #999;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.pagination {\r\n  background-color: #fff;\r\n  padding: 20rpx;\r\n  border-radius: 20rpx;\r\n  margin-top: 20rpx;\r\n}\r\n\r\n.page-info {\r\n  text-align: center;\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.page-controls {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 20rpx;\r\n}\r\n\r\n.page-btn {\r\n  font-size: 26rpx;\r\n  padding: 10rpx 30rpx;\r\n  background-color: #4095E5;\r\n  color: #fff;\r\n  border-radius: 30rpx;\r\n}\r\n\r\n.page-btn[disabled] {\r\n  background-color: #ccc;\r\n  color: #fff;\r\n}\r\n\r\n.page-number {\r\n  font-size: 26rpx;\r\n  color: #333;\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/yulidanprogram/second/EnglishCET-4andCET-6LearningSystem/pages/mine/learning-records/learning-records.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","uniCloud","onMounted","MiniProgramPage"],"mappings":"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"}